<?xml version="1.0" encoding="utf-8"?>
<package name="epiDataCanada" displayName="Add-On to the epi package for Canada data" isAddOn="True" extendsPackage="epi" version="1.0.0">
  <transformers>
    <transformer
      name="DownloadCanada"
      isPrimary="True"
      displayName="Download COVID-19 Canada Data"
      programName="Rscript"
      programArguments="epiCD_download.R"
      runContext="LocalOnly"
      isRunnable ="True">
      <datafeeds>
        <datafeed name="Inputs" displayName="Canada COVID-19 Data - Inputs" dataScope="Scenario">
          <datasheets>
            <datasheet name="Inputs" displayName="Canada COVID-19 Data - Inputs" isSingleRow="True">
              <columns>
                <column name="InputsID" dataType="Integer" isPrimary="True"/>
                <column name="ScenarioID" dataType="Integer" displayName="Scenario"/>
                <column name="Province" dataType="Integer" displayName="Province:" validationType="List"
                  formula1="1:|
                    2:Alberta|
                    3:British Columbia|
                    4:Manitoba|
                    5:New Brunswick|
                    6:Newfoundland and Labrador|
                    7:Northwest Territories|
                    8:Nova Scotia|
                    9:Nunavut|
                    10:Ontario|
                    11:Prince Edward Island|
                    12:Quebec|
                    13:Saskatchewan|
                    14:Yukon"/>
                  <column name="Regions" dataType="Boolean" displayName="Health Regions:"/>
              </columns>
              <defaultRecords>
                <record columns="Province|Regions" values="1|0"/>
              </defaultRecords>
            </datasheet>
          </datasheets>
        </datafeed>
        <datafeed name="Outputs" displayName="Canada COVID-19 - Outputs" dataScope="Scenario">
          <datasheets>
            <datasheet name="Outputs" displayName="Canada COVID-19 - Outputs" isSingleRow="True">
              <columns>
                <column name="OutputsID" dataType="Integer" isPrimary="True"/>
                <column name="ScenarioID" displayName="Scenario" dataType="Integer"/>
                <column name="DownloadDate" dataType="Date" displayName="Download Date:"/>
                <column name="CanadaCaseCSV" dataType="String" displayName="Canada Case CSV:" isExternalFile="True"/>
                <column name="CanadaMortalityCSV" dataType="String" displayName="Canada Mortality CSV:" isExternalFile="True"/>
                <column name="ProvinceCaseCSV" dataType="String" displayName="Province Case CSV:" isExternalFile="True"/>
                <column name="ProvinceMortalityCSV" dataType="String" displayName="Province Case CSV:" isExternalFile="True"/>
                <column name="HealthCaseCSV" dataType="String" displayName="Health Case CSV:" isExternalFile="True"/>
                <column name="HealthMortalityDSV" dataType="String" displayName="Health Mortality CSV:" isExternalFile="True"/>
              </columns>
            </datasheet>
          </datasheets>
        </datafeed>
      </datafeeds>
      <pipeline>
        <datafeed name="Inputs" type="Input"/>
        <datafeed name="Outputs" type="Output"/>
        <datafeed name="epi_DataSummary" type="Output"/>
      </pipeline>
    </transformer>
  </transformers>
  <layouts>
    <layout name="coreforms_ScenarioDatafeeds">
      <group name="epiCDSources" displayName="COVID-19 Canada" appendTo="epi_Sources">
        <item name="Inputs" displayName="Download Settings" itemTransformer="DownloadCanada" showIf="isEither"/>
        <group name="epiCDModels" displayName="Download Results">
          <item name="Outputs" displayName="Raw Data"  itemTransformer="DownloadCanada" showIf="isResult"/>
          <item
            name="epi_DataSummary"
            displayName="Summary Data"
            showIf="isResult"
            viewClassName="SyncroSim.Core.Forms.MultiRowDataFeedView"
            viewClassAssembly="SyncroSim.Core.Forms"
            filterTransformer="DownloadCanada"
            itemTransformer="DownloadCanada"/>
        </group>
      </group>
    </layout>
  </layouts>
</package>
